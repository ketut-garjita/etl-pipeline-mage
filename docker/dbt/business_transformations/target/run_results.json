{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-08-18T05:41:02.214283Z", "invocation_id": "aa2a9455-bd9d-49c5-a64a-ff742798135c", "invocation_started_at": "2025-08-18T05:40:53.159307Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:55.978511Z", "completed_at": "2025-08-18T05:40:56.006114Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:56.007911Z", "completed_at": "2025-08-18T05:40:56.589465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.619330883026123, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_customer_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    \"Customer Id\" AS Customer_Id,\n    \"Customer Email\" AS Customer_Email,\n    \"Customer Fname\" AS Customer_Fname,\n    \"Customer Lname\" AS Customer_Lname,\n    \"Customer Segment\" AS Customer_Segment,\n    \"Customer City\" AS Customer_City,\n    \"Customer Country\" AS Customer_Country,\n    \"Customer State\" AS Customer_State,\n    \"Customer Street\" AS Customer_Street,\n    \"Customer Zipcode\" AS Customer_Zipcode,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_customer\"\n--WHERE \"Customer Id\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_customer_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:56.612010Z", "completed_at": "2025-08-18T05:40:56.622190Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:56.623548Z", "completed_at": "2025-08-18T05:40:56.798488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.19443798065185547, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_department_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    CAST(\"Department Id\" AS INTEGER) AS Department_Id,\n    \"Department Name\" AS Department_Name,\n    \"Market\" AS Market,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_department\"\n--WHERE \"Department Id\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_department_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:56.815696Z", "completed_at": "2025-08-18T05:40:56.828489Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:56.829947Z", "completed_at": "2025-08-18T05:40:57.127559Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3194136619567871, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_location_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    \"Order Zipcode\" AS Order_Zipcode,\n    \"Order City\" AS Order_City,\n    \"Order State\" AS Order_State,\n    \"Order Region\" AS Order_Region,\n    \"Order Country\" AS Order_Country,\n    CAST(\"Latitude\" AS DOUBLE) AS Latitude,\n    CAST(\"Longitude\" AS DOUBLE) AS Longitude,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_location\"\n--WHERE \"Order Zipcode\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_location_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:57.146100Z", "completed_at": "2025-08-18T05:40:57.157035Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:57.158712Z", "completed_at": "2025-08-18T05:40:57.364327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22446417808532715, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_metadata_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    \"key\" AS key,\n    CAST(\"offset\" AS INTEGER) AS metadata_offset,\n    CAST(\"partition\" AS INTEGER) AS partition,\n    CAST(\"time\" AS BIGINT) AS time,\n    \"topic\" AS topic,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_metadata\"\n--WHERE \"key\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_metadata_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:57.379506Z", "completed_at": "2025-08-18T05:40:57.392457Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:57.393747Z", "completed_at": "2025-08-18T05:40:58.559081Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1928722858428955, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_order_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    CAST(\"Order Id\" AS INTEGER) AS Order_Id,\n    --CAST(\"Order date (DateOrders)\" AS TIMESTAMP) AS Order_Date,\n    \"Order date (DateOrders)\" AS Order_Date,\n    CAST(\"Order Customer Id\" AS INTEGER) AS Order_Customer_Id,\n    CAST(\"Order Item Id\" AS INTEGER) AS Order_Item_Id,\n    CAST(\"Product Card Id\" AS INTEGER) AS Product_Card_Id,\n    CAST(\"Order Item Discount\" AS FLOAT) AS Order_Item_Discount,\n    CAST(\"Order Item Discount Rate\" AS FLOAT) AS Order_Item_Discount_Rate,\n    CAST(\"Order Item Product Price\" AS FLOAT) AS Order_Item_Product_Price,\n    \"Order Item Profit Ratio\" AS Order_Item_Profit_Ratio,\n    CAST(\"Order Item Quantity\" AS INTEGER) AS Order_Item_Quantity,\n    CAST(\"Sales per customer\" AS FLOAT) AS Sales_per_customer,\n    CAST(\"Sales\" AS FLOAT) AS Sales,\n    CAST(\"Order Item Total\" AS FLOAT) AS Order_Item_Total,\n    CAST(\"Order Profit Per Order\" AS FLOAT) AS Order_Profit_Per_Order,\n    \"Order Status\" AS Order_Status,\n    CAST(\"Department Id\" AS INTEGER) AS Department_Id,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_order\"\n--WHERE \"Order Id\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_order_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:58.585284Z", "completed_at": "2025-08-18T05:40:58.595963Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:58.597699Z", "completed_at": "2025-08-18T05:40:58.973668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39719581604003906, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_product_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    CAST(\"Product Card Id\" AS INTEGER) AS Product_Card_Id,\n    CAST(\"Product Category Id\" AS INTEGER) AS Product_Category_Id,\n    \"Category Name\" AS Category_Name,\n    CAST(\"Product Description\" AS VARCHAR) AS Product_Description,\n    \"Product Image\" AS Product_Image,\n    \"Product Name\" AS Product_Name,\n    \"Product Price\" AS Product_Price,\n    CASE \n        WHEN LOWER(\"Product Status\") = 'active' THEN 1\n        WHEN LOWER(\"Product Status\") = 'true' THEN 1\n        WHEN \"Product Status\" = '1' THEN 1\n        ELSE 0\n    END::BIT AS Product_Status,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_product\"\n--WHERE \"Product Card Id\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_product_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:58.994056Z", "completed_at": "2025-08-18T05:40:59.003956Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.005606Z", "completed_at": "2025-08-18T05:40:59.228785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24141383171081543, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.stg_shipping_duckdb", "compiled": true, "compiled_code": "\n\nSELECT \n    \"Shipping date (DateOrders)\" AS Shipping_date,\n    \"Days for shipping (real)\" AS Days_for_shipping_real,\n    CAST(\"Days for shipment (scheduled)\" AS INTEGER) AS Days_for_shipment_scheduled,\n    \"Shipping Mode\" AS Shipping_Mode,\n    \"Delivery Status\" AS Delivery_Status,\n    CAST(\"Ingestion_Time\" AS TIMESTAMP) AS ingestion_time\nFROM \"warehouse\".\"main\".\"raw_shipping\"\n--WHERE \"Shipping date (DateOrders)\" IS NOT NULL", "relation_name": "\"warehouse\".\"main\".\"stg_shipping_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.245613Z", "completed_at": "2025-08-18T05:40:59.256545Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.258784Z", "completed_at": "2025-08-18T05:40:59.402450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.16337847709655762, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.dim_customer_duckdb", "compiled": true, "compiled_code": "\n\nWITH cleaned AS (\nSELECT \n    Customer_Id AS Customer_Id,\n    LOWER(Customer_Email) AS Customer_Email,\n    UPPER(LEFT(Customer_Fname, 1)) || LOWER(SUBSTR(Customer_Fname, 2)) AS Customer_Fname,\n    UPPER(LEFT(Customer_Lname, 1)) || LOWER(SUBSTR(Customer_Lname, 2)) AS Customer_Lname,\n    Customer_Segment AS Customer_Segment,\n    Customer_City AS Customer_City,\n    Customer_Country AS Customer_Country,\n    Customer_State AS Customer_State,\n    Customer_Street AS Customer_Street,\n    Customer_Zipcode AS Customer_Zipcode\nFROM \"warehouse\".\"main\".\"stg_customer_duckdb\"\nWHERE Customer_Id IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (\n    PARTITION BY (\n\tCustomer_Id, \n\tCustomer_Email,\n\tCustomer_Fname,\n\tCustomer_Lname,\n\tCustomer_Segment,\n\tCustomer_City,\n\tCustomer_Country,\n\tCustomer_State,\n\tCustomer_Street,\n\tCustomer_Zipcode)\n\tORDER BY Customer_Id) = 1\n    )\n\nSELECT * FROM cleaned", "relation_name": "\"warehouse\".\"main\".\"dim_customer_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.418106Z", "completed_at": "2025-08-18T05:40:59.429059Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.430711Z", "completed_at": "2025-08-18T05:40:59.528808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1159825325012207, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.dim_department_duckdb", "compiled": true, "compiled_code": "\n\nWITH cleaned AS (\nSELECT \n    Department_Id,\n    Department_Name,\n    Market,\n    Ingestion_Time\nFROM \"warehouse\".\"main\".\"stg_department_duckdb\"\nWHERE Department_Id IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY Department_Id, Department_Name, Market) = 1\n)\n\nSELECT * FROM cleaned\nORDER BY Department_Id", "relation_name": "\"warehouse\".\"main\".\"dim_department_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.544471Z", "completed_at": "2025-08-18T05:40:59.578427Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.579941Z", "completed_at": "2025-08-18T05:40:59.666734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12740659713745117, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.dim_location_duckdb", "compiled": true, "compiled_code": "\n\nselect\n    -- attributes\n    \n    \n    cast(Order_Zipcode as TEXT)\n as order_zipcode,\n    \n    \n    cast(Order_City as TEXT)\n as order_city,\n    \n    \n    cast(Order_State as TEXT)\n as order_state,\n    \n    \n    cast(Order_Region as TEXT)\n as order_region,\n    \n    \n    cast(Order_Country as TEXT)\n as order_country,\n    \n    \n    cast(Latitude as float)\n as latitude,\n    \n    \n    cast(Longitude as float)\n as longitude\n\nfrom \"warehouse\".\"main\".\"stg_location_duckdb\"", "relation_name": "\"warehouse\".\"main\".\"dim_location_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.681400Z", "completed_at": "2025-08-18T05:40:59.721151Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.723069Z", "completed_at": "2025-08-18T05:40:59.819733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14412641525268555, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.fact_order_duckdb", "compiled": true, "compiled_code": "\n\nselect\n    -- identifiers\n    \n    \n    cast(Order_Id as integer)\n as order_id,\n    \n    \n    cast(Order_Customer_Id as integer)\n as order_customer_id,\n    \n    \n    cast(Order_Item_Id as integer)\n as order_item_id,\n    \n    \n    cast(Product_Card_Id as integer)\n as product_card_id,\n    \n    \n    cast(Department_Id as integer)\n as department_id,\n    \n    -- attributes\n    \n    \n    cast(Order_Date as TEXT)\n as order_date,\n    \n    \n    cast(Order_Item_Discount as float)\n as order_item_discount,\n    \n    \n    cast(Order_Item_Discount_Rate as float)\n as order_item_discount_rate,\n    \n    \n    cast(Order_Item_Product_Price as float)\n as order_item_product_price,\n    \n    \n    cast(Order_Item_Profit_Ratio as float)\n as order_item_profit_ratio,\n    \n    \n    cast(Order_Item_Quantity as integer)\n as order_item_quantity,\n    \n    \n    cast(Sales_per_customer as float)\n as sales_per_customer,\n    \n    \n    cast(Sales as float)\n as sales,\n    \n    \n    cast(Order_Item_Total as float)\n as order_item_total,\n    \n    \n    cast(Order_Profit_Per_Order as float)\n as order_profit_per_order,\n    \n    \n    cast(Order_Status as TEXT)\n as order_status\n\nfrom \"warehouse\".\"main\".\"stg_order_duckdb\"", "relation_name": "\"warehouse\".\"main\".\"fact_order_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.834576Z", "completed_at": "2025-08-18T05:40:59.857608Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.859011Z", "completed_at": "2025-08-18T05:40:59.955136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12664580345153809, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.dim_product_duckdb", "compiled": true, "compiled_code": "\n\nselect\n    -- identifiers\n    \n    \n    cast(Product_Card_Id as integer)\n as product_card_id,\n    \n    \n    cast(Product_Category_Id as integer)\n as product_category_id,\n    \n    -- attributes\n    \n    \n    cast(Category_Name as TEXT)\n as category_name,\n    \n    \n    cast(Product_Description as TEXT)\n as product_description,\n    \n    \n    cast(Product_Image as TEXT)\n as product_image,\n    \n    \n    cast(Product_Name as TEXT)\n as product_name,\n    \n    \n    cast(Product_Price as float)\n as product_price,\n    \n    \n    cast(Product_Status as TEXT)\n as product_status\n\nfrom \"warehouse\".\"main\".\"stg_product_duckdb\"", "relation_name": "\"warehouse\".\"main\".\"dim_product_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:40:59.972741Z", "completed_at": "2025-08-18T05:40:59.996126Z"}, {"name": "execute", "started_at": "2025-08-18T05:40:59.998030Z", "completed_at": "2025-08-18T05:41:00.099240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13190650939941406, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.dim_shipping_duckdb", "compiled": true, "compiled_code": "\n\nselect\n    -- attributes\n    \n    \n    cast(Shipping_date as TEXT)\n as shipping_date,\n    \n    \n    cast(Days_for_shipping_real as integer)\n as days_for_shipping_real,\n    \n    \n    cast(Days_for_shipment_scheduled as integer)\n as days_for_shipping_scheduled,\n    \n    \n    cast(Shipping_Mode as TEXT)\n as shipping_mode,\n    \n    \n    cast(Delivery_Status as TEXT)\n as delivery_status\n\nfrom \"warehouse\".\"main\".\"stg_shipping_duckdb\"", "relation_name": "\"warehouse\".\"main\".\"dim_shipping_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:00.114943Z", "completed_at": "2025-08-18T05:41:00.129559Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:00.130975Z", "completed_at": "2025-08-18T05:41:00.309900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20349574089050293, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_customer_retention_rate_duckdb", "compiled": true, "compiled_code": "\n\nWITH month_names AS (\n    SELECT 1 AS month_num, 'January' AS month_name UNION ALL\n    SELECT 2, 'February' UNION ALL\n    SELECT 3, 'March' UNION ALL\n    SELECT 4, 'April' UNION ALL\n    SELECT 5, 'May' UNION ALL\n    SELECT 6, 'June' UNION ALL\n    SELECT 7, 'July' UNION ALL\n    SELECT 8, 'August' UNION ALL\n    SELECT 9, 'September' UNION ALL\n    SELECT 10, 'October' UNION ALL\n    SELECT 11, 'November' UNION ALL\n    SELECT 12, 'December'\n), \nmonthly_customers AS (\n    SELECT\n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        COUNT(DISTINCT order_customer_id) AS distinct_customers\n    FROM\n        \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY\n        year, month\n)\nSELECT\n    year,\n    mo.month_name,\n    distinct_customers,\n    SUM(distinct_customers) OVER (ORDER BY year, month) AS rolling_customers,\n    round(distinct_customers/(SUM(distinct_customers) OVER (ORDER BY year, month)),2) as customer_retention_rate\nFROM\n    monthly_customers m\nJOIN month_names mo on m.month =mo.month_num\nORDER BY\n    year, month", "relation_name": "\"warehouse\".\"main\".\"mart_customer_retention_rate_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:00.328540Z", "completed_at": "2025-08-18T05:41:00.339655Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:00.341401Z", "completed_at": "2025-08-18T05:41:00.471998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15096545219421387, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_fraud_detection_duckdb", "compiled": true, "compiled_code": "\n\nwith fraud_detection AS (\n    SELECT\n        order_customer_id,\n        AVG(order_item_total) AS avg_order_total,\n        COUNT(*) AS num_orders\n    FROM \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY order_customer_id\n    ORDER BY avg_order_total DESC\n)\n\nselect * from fraud_detection", "relation_name": "\"warehouse\".\"main\".\"mart_fraud_detection_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:00.486958Z", "completed_at": "2025-08-18T05:41:00.499395Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:00.500960Z", "completed_at": "2025-08-18T05:41:00.693948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2152562141418457, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_inventory_levels_duckdb", "compiled": true, "compiled_code": "\n\nWITH month_names AS (\n    SELECT 1 AS month_num, 'January' AS month_name UNION ALL\n    SELECT 2, 'February' UNION ALL\n    SELECT 3, 'March' UNION ALL\n    SELECT 4, 'April' UNION ALL\n    SELECT 5, 'May' UNION ALL\n    SELECT 6, 'June' UNION ALL\n    SELECT 7, 'July' UNION ALL\n    SELECT 8, 'August' UNION ALL\n    SELECT 9, 'September' UNION ALL\n    SELECT 10, 'October' UNION ALL\n    SELECT 11, 'November' UNION ALL\n    SELECT 12, 'December'\n),\n-- Total inventory value over time\ntotal_inventory_value AS (\n    SELECT\n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        ROUND(SUM(order_item_product_price * order_item_quantity), 2) AS total_inventory_value\n    FROM\n        \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY\n        year, month\n),\n-- Inventory turnover ratio\ninventory_turnover AS (\n    SELECT\n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        ROUND((SUM(order_item_total) / NULLIF(AVG(order_item_quantity), 0)), 2) AS inventory_turnover_ratio\n    FROM \n        \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY \n        year, month\n),\n-- Inventory aging analysis\ninventory_aging AS (\n    SELECT \n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        CASE\n            WHEN date_diff('day', strptime(Order_Date, '%Y-%m-%d %H:%M:%S'), date '2018-01-01') <= 30 THEN '0-30 days'\n            WHEN date_diff('day', strptime(Order_Date, '%Y-%m-%d %H:%M:%S'), date '2018-01-01') <= 60 THEN '31-60 days'\n            WHEN date_diff('day', strptime(Order_Date, '%Y-%m-%d %H:%M:%S'), date '2018-01-01') <= 90 THEN '61-90 days'\n            ELSE 'Over 90 days'\n        END AS age_range,\n        ROUND(SUM(order_item_product_price * order_item_quantity), 2) AS inventory_value\n    FROM \n        \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY \n        year, month, age_range\n)\n\nSELECT\n    t.year,\n    m.month_name,\n    t.total_inventory_value,\n    i.inventory_turnover_ratio,\n    a.age_range,\n    a.inventory_value\nFROM \n    total_inventory_value t\nJOIN \n    month_names m ON t.month = m.month_num\nJOIN \n    inventory_turnover i ON t.year = i.year AND t.month = i.month\nLEFT JOIN\n    inventory_aging a ON t.year = a.year AND t.month = a.month\nORDER BY \n    t.year, t.month", "relation_name": "\"warehouse\".\"main\".\"mart_inventory_levels_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:00.712245Z", "completed_at": "2025-08-18T05:41:00.726142Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:00.727541Z", "completed_at": "2025-08-18T05:41:01.774197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0814323425292969, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_financial_commitments_duckdb", "compiled": true, "compiled_code": "\n\n\nWITH order_aggregates AS (\n    SELECT\n        o.department_id,\n        o.product_card_id,\n        SUM(o.order_item_total) AS total_committed_funds,\n        SUM(CASE WHEN o.order_status = 'COMPLETED' THEN 1 ELSE 0 END) AS completed_orders,\n        COUNT(1) AS total_orders\n    FROM (SELECT department_id, product_card_id, order_item_total, order_status FROM \"warehouse\".\"main\".\"fact_order_duckdb\" LIMIT 50000) o\n    GROUP BY o.department_id, o.product_card_id\n),\ndepartment_market_category AS (\n    SELECT\n        d.department_name,\n        d.market,\n        p.category_name,\n        oa.total_committed_funds,\n        oa.completed_orders,\n        oa.total_orders\n    FROM order_aggregates oa\n    JOIN (SELECT department_id, department_name, market FROM \"warehouse\".\"main\".\"dim_department_duckdb\" LIMIT 50000) d\n      ON oa.department_id = d.department_id\n    JOIN (SELECT product_card_id, category_name FROM \"warehouse\".\"main\".\"dim_product_duckdb\" LIMIT 50000) p\n      ON oa.product_card_id = p.product_card_id\n)\nSELECT\n    department_name,\n    market,\n    category_name,\n    total_committed_funds,\n    completed_orders / total_orders AS commitment_fulfillment_rate\nFROM department_market_category", "relation_name": "\"warehouse\".\"main\".\"mart_financial_commitments_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:01.804277Z", "completed_at": "2025-08-18T05:41:01.816320Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:01.817867Z", "completed_at": "2025-08-18T05:41:02.008727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21505165100097656, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_overall_performance_duckdb", "compiled": true, "compiled_code": "\n\nWITH month_names AS (\n    SELECT 1 AS month_num, 'January' AS month_name UNION ALL\n    SELECT 2, 'February' UNION ALL\n    SELECT 3, 'March' UNION ALL\n    SELECT 4, 'April' UNION ALL\n    SELECT 5, 'May' UNION ALL\n    SELECT 6, 'June' UNION ALL\n    SELECT 7, 'July' UNION ALL\n    SELECT 8, 'August' UNION ALL\n    SELECT 9, 'September' UNION ALL\n    SELECT 10, 'October' UNION ALL\n    SELECT 11, 'November' UNION ALL\n    SELECT 12, 'December'\n),\noverall_sales_performance AS (\n    SELECT \n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        ROUND(SUM(order_item_total), 2) AS total_sales,\n        ROUND(SUM(order_profit_per_order), 2) AS total_profit\n    FROM \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY year, month\n),\nprofit_margin_analysis AS (\n    SELECT \n        EXTRACT(YEAR FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS year,\n        EXTRACT(MONTH FROM strptime(order_date, '%Y-%m-%d %H:%M:%S')) AS month,\n        ROUND(AVG(order_profit_per_order), 2) AS avg_profit_margin\n    FROM \"warehouse\".\"main\".\"fact_order_duckdb\"\n    GROUP BY year, month\n),\noperational_efficiency_metrics AS (\n    SELECT \n        ROUND(AVG(days_for_shipping_real), 2) AS avg_actual_shipment_days,\n        ROUND(AVG(days_for_shipping_scheduled), 2) AS avg_scheduled_shipment_days\n    FROM \"warehouse\".\"main\".\"dim_shipping_duckdb\"\n)\nSELECT \n    os.year,\n    m.month_name,\n    os.total_sales,\n    os.total_profit,\n    pma.avg_profit_margin,\n    oem.avg_actual_shipment_days,\n    oem.avg_scheduled_shipment_days\nFROM \n    overall_sales_performance os\nJOIN \n    profit_margin_analysis pma ON os.year = pma.year AND os.month = pma.month\nJOIN\n    month_names m ON os.month = m.month_num\nCROSS JOIN \n    operational_efficiency_metrics oem\nORDER BY \n    os.year, os.month", "relation_name": "\"warehouse\".\"main\".\"mart_overall_performance_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-18T05:41:02.037814Z", "completed_at": "2025-08-18T05:41:02.049198Z"}, {"name": "execute", "started_at": "2025-08-18T05:41:02.050829Z", "completed_at": "2025-08-18T05:41:02.173642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1432666778564453, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.data_pipeline.mart_payment_delays_duckdb", "compiled": true, "compiled_code": "\nselect\n    delivery_status,\n    AVG(days_for_shipping_real - days_for_shipping_scheduled) AS avg_payment_delay,\n    COUNT(1) AS count_of_orders\nFROM \"warehouse\".\"main\".\"dim_shipping_duckdb\"\nGROUP BY delivery_status", "relation_name": "\"warehouse\".\"main\".\"mart_payment_delays_duckdb\"", "batch_results": null}], "elapsed_time": 6.862386226654053, "args": {"log_level_file": "debug", "require_resource_names_without_spaces": true, "which": "run", "version_check": true, "send_anonymous_usage_stats": true, "empty": false, "select": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": true, "partial_parse": true, "state_modified_compare_vars": false, "require_generic_test_arguments_property": false, "validate_macro_args": false, "printer_width": 80, "log_path": "/home/src/dataeng-2/dbt/business_transformations/logs", "defer": false, "cache_selected_only": false, "target": "duckdb", "project_dir": "/home/src/dataeng-2/dbt/business_transformations", "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "use_colors_file": true, "require_nested_cumulative_type_params": false, "profiles_dir": "/home/src/dataeng-2/dbt/business_transformations", "indirect_selection": "eager", "static_parser": true, "introspect": true, "write_json": true, "strict_mode": false, "favor_state": false, "show_all_deprecations": false, "macro_debugging": false, "vars": {}, "print": true, "quiet": false, "log_level": "info", "exclude": [], "require_all_warnings_handled_by_warn_error": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format_file": "debug", "partial_parse_file_diff": true, "use_colors": true, "use_fast_test_edges": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "log_format": "default", "state_modified_compare_more_unrendered_values": false, "upload_to_artifacts_ingest_api": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt run --target duckdb"}}